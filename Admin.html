<!doctype html>
<html lang="en">
<meta charset="utf-8">
<head>
	<title>Administrative Page</title>	
	<link rel="stylesheet" type="text/css" href="css/style.css">
</head>

<body>
	<header id="my-header">
		<div class="container">
			<ul><li>
				<a href="Home.html">Home</a></li><li>
				<a href="ShowCase.html">Projects</a></li><li>				
				<a href="https://github.com/AboutTreeFittyy">GitHub</a></li><li>				
				<a href="https://www.linkedin.com/">LinkedIn</a></li><li>
				<a href="Admin.html">Temp</a></li><li>
				<a href="EncodedLiving.html">Game</a></li><li>
			</li></ul>
		</div>		
	</header>
	<section class="my-form" id="my-form">
		<div class="container">
			<h1>ShowCase Management</h1>
			<div id="imageTest"><img id="test1"><img id="test2"><img id="test3"></div>
			<form enctype="multipart/form-data" id="uploadProject" method="post">
				<h2>Add New Project:</h2>
				Title <input type="text" id="projectTitle" name="title"><br>
				Description<input type="text" id="projectDescription" name="description"><br>
				Add Skills: 
				<input type="checkbox" id="projectSkill0" name="skill">Skill 1
				<input type="checkbox" id="projectSkill1" name="skill">Skill 2
				<input type="checkbox" id="projectSkill2" name="skill">Skill 3<br>Add Image:
				<input class="button" id="projectImage" type="file" name="file"><br><br>
				<input class="button" type="submit" name="upload" value="upload"><br><br>
			</form>
			<form enctype="multipart/form-data" action=".php" method="post">
				<h2>Edit Item Order:</h2>
				<div class="dropdown">
					<button class="drop">Skill 1</button>
					<div class="dropdown-skills">
						<a href="#">1</a>
						<a href="#">2</a>
						<a href="#">3</a>
					</div>
				</div>
				<div class="dropdown">
					<button class="drop">Skill 2</button>
					<div class="dropdown-skills">
						<a href="#">1</a>
						<a href="#">2</a>
						<a href="#">3</a>
					</div>
				</div>
				<div class="dropdown">
					<button class="drop">Skill 3</button>
					<div class="dropdown-skills">
						<a href="#">1</a>
						<a href="#">2</a>
						<a href="#">3</a>
					</div>
				</div>
			</form>
				<h1>HomePage Management</h1>

				<h2>Add New Skill:</h2>
				Title<input type="text" name="newtitle"><br>
				Summary<input type="text" name="summary"><br>

				<h2>Remove Skill:</h2>
			<form enctype="multipart/form-data" action=".php" method="post">
				<input type="radio" value="Skill" name="skillremove1">Skill 1
				<input type="radio" value="Skill" name="skillremove2">Skill 2
				<input type="radio" value="Skill" name="skillremove3">Skill 3<br>

				<h2>Change Main Picture:</h2>
				<input class="button" type="submit" value="Upload Photo">

				<h2>Change Details:</h2>
				Name<input type="text" name="name"><br>
				Description<input type="text" name="namedescription"><br>
				<input class="button" type="submit" value="Save Changes">
			</form> 
		</div>
	</section>
	<div class="container">
		<footer id="my-footer">
			<p>Author: Mathew Boland - Last Updated:September 15, 2019</p>
		</footer>
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script> 
	<script type="text/javascript" src="AdminManager.js"></script>
	<script>
		$(document).ready(function(){		 
			$('#uploadProject').on('submit', function(event){
				event.preventDefault();
				//Get image from form and make copies for db
				var file = document.querySelector('input[type=file]').files[0];
				var reader = new FileReader();
				var main_image, mobileImage, thumbNail;
				var image = new Image();
				reader.readAsDataURL(file);
				reader.onload = () =>{					
					image.src = reader.result;	
					image.onload = () =>{
						main_image = normalizeImage(image);
						if(main_image != null){
							alert("Valid Photo");
							mobileImage = createMobileImageCopy(main_image);
							thumbnail = createThumbNailCopy(main_image);
							document.getElementById("test1").src = main_image;
							document.getElementById("test2").src = mobileImage;
							document.getElementById("test3").src = thumbnail;
							//reader.readAsDataURL(file);
							var image_name = $('#projectImage').val();
							var path = document.getElementById('projectImage').value;
							//Get file name with extension
							var file_name;
							if (path) {
								var start = (path.indexOf('\\') >= 0 ? path.lastIndexOf('\\') : path.lastIndexOf('/'));
								file_name = path.substring(start);
								if (file_name.indexOf('\\') === 0 || file_name.indexOf('/') === 0) {
									file_name = file_name.substring(1);
								}
							}
							//contains data for database only
							var dataPost = {
							"title" : document.getElementById("projectTitle").value,
							"description" : document.getElementById("projectDescription").value,
							"fileName" : file_name
							};							
							var dataString = JSON.stringify(dataPost);
							//Now send the ShowCase data so it can be added to the database
							$.ajax({
									url:"addShowCaseData.php",
									method: "POST",
									data: {myData: dataString},
									success:function(data){
										alert(data);
									}
							});							
						}else{
							alert("Invalid Photo Uploaded");
						}
					};					
				};	
			});		 
		});  
		function addProject(){
			//Save the text elements
			var title = document.getElementById("projectTitle").value;
			var description = document.getElementById("projectDescription").value;
			//Now save which skills are selected
			var skill = [];
			//Check projectSkill ids until they don't exist anymore
			for (var i = 0; document.getElementById("projectSkill"+i) != null; i++){
				//Lastly check if the skill was selected before saving it
				if(document.getElementById("projectSkill"+i).checked === true){
					skill.push(i);
				}
			}
			//Get image from form and make copies for db
			var file = document.querySelector('input[type=file]').files[0];
			var reader = new FileReader();
			var image, mobileImage, thumbNail;
			reader.onloadend = function(){
				image = normalizeImage(reader.result);
				if(image != null){
					mobileImage = createMobileImageCopy(image);
					thumbnail = createThumbNailCopy(image);
					document.getElementById("test1").src = image;
					document.getElementById("test2").src = mobileImage;
					document.getElementById("test3").src = thumbnail;
				}else{
					alert("Invalid Photo Uploaded");
				}				
			}			
			reader.readAsDataURL(file);			
		}
	</script>
</body>
</html>